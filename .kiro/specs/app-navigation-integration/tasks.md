# خطة التنفيذ

- [x] 1. إنشاء نظام التنقل الأساسي
  - [x] 1.1 إنشاء ملف تكوين التنقل (src/config/navigation.ts)
    - تعريف جميع عناصر القائمة مع الأيقونات والمسارات والأدوار
    - إضافة دعم الشارات (badges) للعناصر الجديدة
    - تصدير دوال مساعدة لتصفية العناصر حسب الدور
    - _Requirements: 2.1, 3.1, 3.2, 3.3_
  
  - [x] 1.2 تحسين مكون Sidebar
    - إضافة حالة نشطة مع مؤشر حدود أيسر 4px
    - تطبيق انتقالات CSS سلسة (300ms)
    - تحسين موضع التلميحات للحالة المطوية مع دعم RTL
    - إضافة دعم التنقل بلوحة المفاتيح (أسهم، Enter)
    - _Requirements: 1.1, 1.2, 2.2, 2.3, 2.4_
  
  - [x] 1.3 إنشاء مكون Breadcrumbs
    - تحليل pathname وإنشاء مسار التنقل تلقائياً
    - عرض روابط قابلة للنقر مع فواصل
    - اختصار المسارات الطويلة (> 4 مستويات)
    - دعم RTL كامل مع عكس الترتيب
    - _Requirements: 6.1, 6.2, 6.3, 6.4, 6.5_

- [x] 2. إنشاء نظام الإشعارات المتكامل
  - [x] 2.1 إنشاء NotificationContext مع جميع العمليات
    - إدارة حالة الإشعارات (add, read, remove, clear)
    - حفظ الإشعارات في localStorage
    - حساب عدد الإشعارات غير المقروءة
    - _Requirements: 7.1, 7.2, 14.3_
  
  - [x] 2.2 إنشاء مكونات الإشعارات (NotificationBell, Dropdown, Item)
    - عرض أيقونة الجرس مع شارة العدد
    - قائمة منسدلة مع الإشعارات الأخيرة
    - أزرار الإجراءات وحالة فارغة
    - دعم أنواع مختلفة (info, success, warning, error)
    - _Requirements: 7.1, 7.2_
  
  - [x] 2.3 دمج الإشعارات في Header
    - إضافة NotificationBell إلى الهيدر
    - تحسين قائمة المستخدم المنسدلة
    - إضافة سلوك sticky مع ظل عند التمرير
    - تحسين التخطيط للموبايل
    - _Requirements: 7.3, 7.4, 7.5, 15.3_

- [ ] 3. إنشاء نظام حالات التحميل والفراغ
  - [x] 3.1 إنشاء مكونات التحميل
    - PageLoader للشاشة الكاملة مع شعار الشركة وشريط تقدم
    - Skeleton loaders (Table, Chart, Card, Form) مع رسوم متحركة
    - تحسين Button مع حالة loading
    - معالجة timeout (3 ثواني) مع خيار إعادة المحاولة
    - _Requirements: 9.1, 9.2, 9.3, 9.4, 9.5_
  
  - [x] 3.2 إنشاء مكون EmptyState موحد
    - دعم أنواع مختلفة (no-data, no-results, no-access, error)
    - أيقونة، عنوان، وصف، وزر إجراء
    - تطبيق على جميع الصفحات (Data Log, Analytics, Audit, Backup, Notifications)
    - _Requirements: 10.1, 10.2, 10.3, 10.4, 10.5_

- [ ] 4. إنشاء نظام معالجة الأخطاء الشامل
  - [x] 4.1 تحسين ErrorBoundary ومكونات الأخطاء
    - التقاط أخطاء React وعرض صفحة خطأ سهلة الاستخدام
    - إنشاء ErrorState مع أزرار إعادة المحاولة
    - تسجيل الأخطاء في خدمة المراقبة
    - _Requirements: 11.1_
  
  - [x] 4.2 إنشاء صفحة access-denied وAPI error handler
    - صفحة رفض الوصول مع شرح الصلاحيات المطلوبة
    - معالج أخطاء API (401→login, 403→access-denied, 404→toast, 500→error)
    - معالجة أخطاء الشبكة مع مؤشر offline
    - معالجة أخطاء التحقق من النماذج مع رسوم متحركة
    - _Requirements: 11.2, 11.3, 11.4, 11.5_

- [ ] 5. تطبيق إمكانية الوصول والاختصارات
  - [ ] 5.1 إنشاء نظام اختصارات لوحة المفاتيح
    - Hook للاختصارات العامة (/, Ctrl+K, Ctrl+N, Ctrl+B, Esc, Alt+1-9)
    - مكون KeyboardShortcutsHelp يُفتح بـ "?"
    - إدارة التركيز للنوافذ المنبثقة (focus trap)
    - _Requirements: 12.2, 12.4_
  
  - [ ] 5.2 إضافة ميزات إمكانية الوصول
    - رابط "تخطي إلى المحتوى الرئيسي"
    - ARIA labels لجميع الأزرار
    - مؤشرات تركيز واضحة
    - ARIA live regions للمحتوى الديناميكي
    - _Requirements: 12.1, 12.3, 12.5_

- [ ] 6. تحسين الأداء والتحميل
  - [x] 6.1 تقسيم الكود وتحسين الحزمة
    - Lazy loading للمكونات الثقيلة (Analytics charts, PDF viewer)
    - تحسين الصور باستخدام next/image
    - إزالة التبعيات غير المستخدمة
    - استهداف حجم حزمة < 500KB
    - _Requirements: 13.1, 13.2, 13.4, 13.5_
  
  - [x] 6.2 تطبيق التخزين المؤقت وإدارة الحالة
    - إضافة SWR/React Query للتخزين المؤقت (5 دقائق)
    - حفظ حالة الشريط الجانبي والثيم واللغة
    - استعادة موضع التمرير عند الرجوع
    - حفظ حالة الفلاتر بين الصفحات
    - _Requirements: 13.3, 14.1, 14.2, 14.3, 14.4, 14.5_

- [-] 7. إضافة الرسوم المتحركة والانتقالات
  - [-] 7.1 إنشاء فئات الرسوم المتحركة
    - PageTransition للانتقال بين الصفحات (200ms fade)
    - رسوم متحركة للقوائم المنسدلة والنوافذ المنبثقة
    - دعم prefers-reduced-motion
    - تحسين الأداء (60fps، CSS transforms)
    - _Requirements: 15.1, 15.2, 15.3, 15.4, 15.5_

- [ ] 8. تحسين التنقل بين الصفحات
  - [ ] 8.1 تحسين تدفق Data Entry
    - Toast مع أزرار "عرض في سجل البيانات" و"إضافة عنصر آخر"
    - عرض بطاقة العنصر المضاف مؤخراً
    - _Requirements: 8.1_
  
  - [ ] 8.2 ربط Data Log و Analytics
    - زر "عرض التحليلات" في Data Log مع نقل الفلاتر
    - رابط "عرض البيانات الخام" في Analytics
    - جعل نقاط البيانات في الرسوم البيانية قابلة للنقر
    - _Requirements: 8.3, 8.4_
  
  - [ ] 8.3 ربط Audit بالعناصر
    - جعل إدخالات التدقيق قابلة للنقر
    - عرض تفاصيل العنصر من سجل التدقيق
    - _Requirements: 8.5_

- [ ] 9. تحسين لوحة التحكم (Dashboard)
  - [ ] 9.1 إنشاء بطاقة الترحيب والإحصائيات السريعة
    - ترحيب شخصي مع التاريخ والوقت
    - إحصائيات سريعة (اليوم، الأسبوع، الشهر)
    - _Requirements: 8.1_
  
  - [ ] 9.2 إنشاء شبكة الإجراءات السريعة
    - أزرار كبيرة (إضافة عنصر، سجل البيانات، التقارير، التحليلات)
    - _Requirements: 8.1_
  
  - [ ] 9.3 إضافة الجدول الزمني للنشاط الأخير
    - عرض آخر 10 إدخالات مع رابط "عرض الكل"
    - _Requirements: 8.1_
  
  - [ ] 9.4 إضافة بطاقات الإحصائيات والرسوم البيانية المصغرة
    - بطاقات الإحصائيات (إجمالي العناصر، معدل الرفض، المستخدمين النشطين)
    - رسوم بيانية صغيرة (اتجاه الإدخالات، توزيع ميس/فوزان)
    - _Requirements: 8.1_
  
  - [ ] 9.5 تطبيق محتوى لوحة التحكم حسب الدور
    - محتوى مخصص لكل دور (DATA_ENTRY, SUPERVISOR, MANAGER, AUDITOR, ADMIN)
    - _Requirements: 8.1_

- [ ] 10. تحديث الترجمات والتكوين
  - [ ] 10.1 تحديث ملفات الترجمة
    - ترجمات التنقل والقوائم
    - ترجمات الحالات الفارغة والأخطاء
    - ترجمات الإشعارات والاختصارات
    - ترجمات مسار التنقل (Breadcrumbs)
    - _Requirements: 6.3_
  
  - [ ] 10.2 التحقق من حماية المسارات
    - التحقق من صلاحيات المسارات في Middleware
    - اختبار إعادة التوجيه لصفحة access-denied
    - اختبار معالجة انتهاء الجلسة
    - _Requirements: 4.1, 4.2, 4.3, 4.4, 4.5_
  
  - [ ] 10.3 تحسينات التنقل للموبايل
    - التحقق من قائمة الهامبرغر
    - إغلاق الشريط الجانبي بعد التنقل
    - تحسين تخطيط الهيدر للشاشات الصغيرة
    - اختبار التفاعلات باللمس
    - _Requirements: 5.1, 5.2, 5.3, 5.4, 5.5_

- [ ]* 11. الاختبارات والتدقيق
  - [ ]* 11.1 اختبارات الوحدة
    - اختبار Sidebar (تصفية الأدوار، الحالة، التنقل بلوحة المفاتيح)
    - اختبار Header (Breadcrumbs، القوائم المنسدلة، الإشعارات)
    - اختبار NotificationContext (إضافة، قراءة، حذف)
    - اختبار EmptyState و ErrorBoundary
    - _Requirements: 2.1-2.4, 6.1-6.5, 7.1-7.2, 10.1-10.5, 11.1_
  
  - [ ]* 11.2 اختبارات التكامل
    - اختبار تدفق التنقل والمصادقة والتفويض
    - اختبار معالجة الأخطاء
    - _Requirements: 3.1-3.5, 4.1-4.5, 8.1-8.5, 11.1-11.5_
  
  - [ ]* 11.3 تدقيق إمكانية الوصول
    - تشغيل jest-axe على جميع المكونات
    - اختبار يدوي بلوحة المفاتيح وقارئ الشاشة
    - التحقق من WCAG AA
    - _Requirements: 12.1-12.5_
  
  - [ ]* 11.4 تدقيق الأداء
    - تشغيل Lighthouse (درجة > 90)
    - تحليل حجم الحزمة (< 500KB)
    - اختبار على اتصالات بطيئة (3G)
    - _Requirements: 9.5, 13.2, 13.5_

- [ ]* 12. التلميع النهائي والتوثيق
  - [ ]* 12.1 تنظيف الكود
    - إزالة console.log والواردات غير المستخدمة
    - إصلاح أخطاء TypeScript و ESLint
    - تنسيق الكود بـ Prettier
    - _Requirements: All_
  
  - [ ]* 12.2 تحديث التوثيق
    - توثيق المكونات الجديدة
    - تحديث README مع ميزات التنقل
    - توثيق اختصارات لوحة المفاتيح
    - دليل استكشاف الأخطاء
    - _Requirements: All_
  
  - [ ]* 12.3 قائمة التحقق من النشر
    - التحقق من متغيرات البيئة
    - اختبار بناء الإنتاج
    - التحقق من ترحيلات قاعدة البيانات
    - اختبار على بيئة التجهيز
    - _Requirements: All_
